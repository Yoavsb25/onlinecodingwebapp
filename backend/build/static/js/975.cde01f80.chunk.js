"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[975],{975:(e,s,t)=>{t.r(s),t.d(s,{default:()=>w});var n=t(43),o=t(216),r=t(104);const c=e=>e?e.replace(/\s+/g," ").replace(/\n+/g,"\n").trim():"",a={loading:!0,error:null,code:"",solution:"",name:"",output:"",isRunning:!1,isSolved:void 0,userCount:1,question:""};function l(e,s){switch(s.type){case"SET_CODE_BLOCK":return{...e,loading:!1,name:s.payload.name,code:s.payload.content,solution:s.payload.solution};case"SET_CODE":return{...e,code:s.payload};case"SET_OUTPUT":return{...e,output:s.payload};case"SET_RUNNING":return{...e,isRunning:s.payload};case"SET_IS_SOLVED":return{...e,isSolved:s.payload};case"SET_ERROR":return{...e,error:s.payload,loading:!1};case"UPDATE_USER_COUNT":return{...e,userCount:s.payload};default:return e}}var i=t(269),d=t(590),u=t(474),m=t(830),x=t(210),p=t(614),h=t(579);const y=n.memo((e=>{let{code:s,onChange:t,onRun:n,isRunning:o,isSolved:r}=e;return(0,h.jsx)("div",{className:"relative",children:(0,h.jsxs)("div",{className:"rounded-lg overflow-hidden shadow-2xl bg-gray-800",children:[(0,h.jsx)(i.Ay,{value:s,height:"400px",theme:u.bM,extensions:[(0,d.Q2)()],onChange:t,className:"text-base"}),(0,h.jsxs)("div",{className:"p-4 border-t border-gray-700 flex justify-between items-center",children:[(0,h.jsxs)("button",{onClick:n,disabled:o,className:"flex items-center px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,h.jsx)(m.A,{className:"mr-2",size:16}),o?"Running...":"Run Code"]}),void 0!==r&&(0,h.jsx)("div",{className:"flex items-center",children:r?(0,h.jsxs)("div",{className:"flex items-center text-green-400",children:[(0,h.jsx)(x.A,{size:24,className:"mr-2"}),(0,h.jsx)("span",{children:"Correct solution!"})]}):(0,h.jsxs)("div",{className:"flex items-center text-red-400",children:[(0,h.jsx)(p.A,{size:24,className:"mr-2"}),(0,h.jsx)("span",{children:"Try again"})]})})]})]})})})),g=n.memo((e=>{let{output:s,isSolved:t}=e;return(0,h.jsxs)("div",{className:"rounded-lg overflow-hidden shadow-2xl bg-gray-800",children:[(0,h.jsxs)("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center",children:[(0,h.jsx)("h2",{className:"text-lg font-semibold",children:"Output"}),void 0!==t&&(0,h.jsx)("div",{className:"text-4xl",role:"img","aria-label":t?"Success":"Try Again",children:t?"\ud83d\ude0a":"\ud83d\ude14"})]}),(0,h.jsx)("div",{className:"p-4 font-mono text-sm h-[400px] overflow-auto whitespace-pre-wrap",children:s||"No output yet. Run your code to see results."})]})}));var j=t(469),b=t(118),f=t(54),N=t(819);const v=n.memo((e=>{let{onBack:s,userCount:t,connected:n,name:o,role:r}=e;return(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,h.jsxs)("button",{onClick:s,className:"flex items-center text-gray-400 hover:text-white transition-colors",children:[(0,h.jsx)(j.A,{className:"mr-2",size:20}),"Back to Lobby"]}),(0,h.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,h.jsxs)("div",{className:"flex items-center text-gray-400",children:[(0,h.jsx)(b.A,{className:"mr-2",size:20}),t," user",1!==t?"s":""," online"]}),n?(0,h.jsxs)("div",{className:"flex items-center text-green-400",children:[(0,h.jsx)(f.A,{className:"mr-2",size:20}),"Connected"]}):(0,h.jsxs)("div",{className:"flex items-center text-red-400",children:[(0,h.jsx)(N.A,{className:"mr-2",size:20}),"Disconnected"]}),r&&(0,h.jsx)("div",{className:"flex items-center "+("mentor"===r?"text-yellow-400":"text-blue-400"),children:"mentor"===r?"\ud83d\udc68\u200d\ud83c\udfeb Mentor":"\ud83d\udc69\u200d\ud83d\udcbb Student"})]})]}),(0,h.jsx)("div",{className:"mb-6",children:(0,h.jsx)("h1",{className:"text-3xl font-bold mb-2",children:o})})]})})),S=e=>{let{error:s}=e;return(0,h.jsx)("div",{className:"flex justify-center items-center min-h-screen bg-red-600 text-white",children:(0,h.jsxs)("div",{className:"text-center p-4 border rounded-lg shadow-lg bg-red-700",children:[(0,h.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Oops! Something went wrong."}),(0,h.jsx)("p",{children:s}),(0,h.jsx)("p",{className:"mt-4",children:"Please try again later or contact support if the issue persists."})]})})},C=()=>(0,h.jsx)("div",{className:"flex justify-center items-center min-h-screen",children:(0,h.jsx)("div",{className:"spinner-border animate-spin inline-block w-8 h-8 border-4 border-t-transparent border-blue-500 rounded-full",role:"status",children:(0,h.jsx)("span",{className:"sr-only",children:"Loading..."})})}),E="http://127.0.0.1:5000";const w=function(){const{id:e}=(0,o.g)(),s=(0,o.Zp)(),[t,i]=(0,n.useReducer)(l,{...a,isSolved:void 0,role:"student"}),d=(0,n.useCallback)((e=>{let{code:s}=e;i({type:"SET_CODE",payload:s})}),[]),u=(0,n.useCallback)((e=>{i({type:"UPDATE_USER_COUNT",payload:e})}),[]),{connected:m,error:x,emitCodeChange:p}=((e,s,t,o,c)=>{const[a,l]=(0,n.useState)({socket:null,connected:!1,error:null});(0,n.useEffect)((()=>{const n=(0,r.io)(e,{transports:["websocket"],reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3});return n.on("connect",(()=>{l((e=>({...e,connected:!0,error:null}))),n.emit("join",{room:`code-block-${s}`})})),n.on("disconnect",(()=>{l((e=>({...e,connected:!1})))})),n.on("error",(e=>{l((s=>({...s,error:e.message})))})),n.on("code_update",t),n.on("solution_matched",(()=>c(!0))),n.on("user_joined",(()=>o((e=>e+1)))),n.on("user_left",(()=>o((e=>Math.max(1,e-1))))),l((e=>({...e,socket:n}))),()=>{n&&(n.emit("leave",{room:`code-block-${s}`}),n.disconnect())}}),[e,s,t,o,c]);const i=(0,n.useCallback)((e=>{a.socket&&a.connected&&a.socket.emit("code_change",{room:`code-block-${s}`,code:e})}),[a.socket,a.connected,s]);return{...a,emitCodeChange:i}})(E,e,d,u);(0,n.useEffect)((()=>{(async()=>{try{const s=await fetch(`${E}/api/code-blocks/${e}`);if(!s.ok)throw new Error("Failed to fetch code block");const t=await s.json();i({type:"SET_CODE_BLOCK",payload:t})}catch(s){i({type:"SET_ERROR",payload:s.message})}})()}),[e]);const j=(0,n.useCallback)((e=>{i({type:"SET_CODE",payload:e}),p(e)}),[p]),b=(0,n.useCallback)((async()=>{i({type:"SET_RUNNING",payload:!0});try{const{output:e,success:s}=await async function(e,s){try{if(!e||!e.trim())return{success:!1,output:"No code to execute"};const t=c(e),n=c(s);let o=[];const r={log:function(){for(var e=arguments.length,s=new Array(e),t=0;t<e;t++)s[t]=arguments[t];o.push(s.map((e=>"object"===typeof e?JSON.stringify(e):String(e))).join(" "))},error:function(){for(var e=arguments.length,s=new Array(e),t=0;t<e;t++)s[t]=arguments[t];o.push("Error: "+s.map((e=>"object"===typeof e?JSON.stringify(e):String(e))).join(" "))}},a=new Function("console",e)(r),l=o.length>0?o.join("\n"):void 0!==a?String(a):"Code executed successfully",i=t===n;return console.log("Code comparison:",{normalizedCode:t,normalizedSolution:n,isCorrect:i}),{success:i,output:l}}catch(t){return{success:!1,output:`Error: ${t.message}`}}}(t.code,t.solution);i({type:"SET_OUTPUT",payload:e}),i({type:"SET_IS_SOLVED",payload:s});const n=e=>e.replace(/\/\/.*$/gm,"").replace(/\/\*[\s\S]*?\*\//g,"").replace(/^\s*[\r\n]/gm,"").trim(),o=n(t.code),r=o===n(t.solution);i({type:"SET_IS_SOLVED",payload:r}),console.log("Code execution result:",{output:e,success:s,codeMatches:r})}catch(e){i({type:"SET_OUTPUT",payload:`Error: ${e.message}`}),i({type:"SET_IS_SOLVED",payload:!1})}finally{i({type:"SET_RUNNING",payload:!1})}}),[t.code,t.solution]);return t.loading?(0,h.jsx)(C,{}):t.error?(0,h.jsx)(S,{error:t.error}):(0,h.jsx)("div",{className:"min-h-screen bg-gray-900 text-white",children:(0,h.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,h.jsx)(v,{onBack:()=>s("/"),userCount:t.userCount,connected:m,name:t.name,role:t.role}),(0,h.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,h.jsx)(y,{code:t.code,onChange:j,onRun:b,isRunning:t.isRunning,isSolved:t.isSolved}),(0,h.jsx)(g,{output:t.output,isSolved:t.isSolved})]})]})})}}}]);
//# sourceMappingURL=975.cde01f80.chunk.js.map